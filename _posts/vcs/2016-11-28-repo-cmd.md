---
layout: post
title: "理解 repo"
categories: VCS
tags: repo
---

* content
{:toc}

在安卓平台开发中，特别是维护源代码的时候，经常会用到 repo 命令。因此理解 repo 的用法
非常重要。repo 是 Google 开发的一个 Python 脚本工具，仍在不断进化中。 由于 repo 是
一个 git 命令的包裹脚本，自然会涉及到 git 的相关概念，导致初次接触时，不太容易理解。

## repo 的组成

repo 的实现主要包括两部分：repo 引导脚本（Google 称之为 repo launcher）和 repo 命令
的主体部分。

### repo 仓库布局

我们参照 aosp 的仓库，来看看 repo 到底长什么样子：

    ├── manifests
    ├── manifests.git
    ├── manifest.xml -> manifests/default.xml
    ├── project.list
    ├── project-objects
    ├── projects
    └── repo

当你执行 `repo init` 命令来初始化仓库的时候首先执行的就是 repo 的引导脚本。该脚本会到
你指定的地方去下载 manifest 仓库，以及 repo 命令主体部分。下载好之后就放在当前目录下面
的 .repo 目录下，如上图所示。

+ manifests：载货单的 git 仓库
+ manifests.git：载货单的 git 裸仓库，不带工作区
+ manifest.xml：这是一个链接文件，指向你的用于初始化工作区的载货单
+ project.list：一个文本文件，里面包含所有项目名字的列表
+ projects：该文件夹下包含所有 git project 的裸仓库，文件夹的层次结构跟工作区的布局
  一样
+ repo：这是 repo 命令的主体，其中也包含最新的 repo 命令，推荐时常使用这里面的 repo 
  命令更新你的计算机上的 repo 命令，因为新版本的 repo 命令提供了更多的有助于你工作的
  子命令以及选项。

### 什么是 manifest 仓库